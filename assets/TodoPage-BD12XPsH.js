import{u as U,i as A,d as y,j as C,k as E,g as i,c as a,a as t,h as $,t as g,f as w,w as Y,v as H,n as _,F as N,l as D,o as l,m as G}from"./index-DpiG5eUE.js";import{_ as V}from"./logo-D-z1wDM4.js";const M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAYAAABHomvIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADxSURBVHgB7ZjRDcIgEIYP0wG6gR2lI7iBOoITOEJHcAU3kE2KG3QDvIulD5qSyF/be7gv+UMDCflKAjkgUo6jBYgx1twcOfXYFTjeOfekrWG5htPHb/pRfHPBLs5zJZAd4eRWqSGQJQT/igmimCCKCaKYIIoJoqgXrNIHVx57KiNXLNSl86Za0kk9x+2N05IuAqcVwQfpk0t4EYykGNvFKCLoSS9eBM/03jHa8JzTdC8ej5sSOs5hZuzOuVABfA4GaavPjl/hHxsyw0PpvAnbxSgmiGKCKCaIYoIoJoiyhGDIjOUKiXWQl/zMK3/pVXbiBWQViHGLJSIlAAAAAElFTkSuQmCC",j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAbCAYAAACN1PRVAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEQSURBVHgB7dRbDgExFAbg/wze7YBnEWIH7MASWIGGDdiAyw7EEqyAHSDEMzuYd5c67YS4zNDOJSGZ/6XtdNIvp2kLpPmHyG23Kne9guoTEozcigkkWt6IRGLYM6TjOkggPpDaQzf2ynwhPUHNWCsLhC7UospoFltlH6HqaKq6sWAmkMbkUuSRRYd/5jYzptLgAIuYQioOQxNu+1yjwPm8UpcQCUAeBjQfxnnIy8IEtIVu2OLl21cwDORhJ7R5C/emYFhIRZ9GPiRF5DDnRYov8y7IqVN5uI4K3TETkFcUUaAn7AvoHwvoDbMCLSFfzAgMAQViH8GQkErgq0+18R5HNB6uhRsFMo7ciLp+Q9P8Qq42brLMkgfxBgAAAABJRU5ErkJggg==",K={class:"todo-page-wrap"},z=t("h1",{class:"sr-only"},"最實用的線上代辦事項服務",-1),L={class:"section-todolist"},O={class:"todo-header d-flex align-items-center"},J=t("div",{class:"todo-logo-pic me-auto"},[t("img",{src:V,alt:"logo"})],-1),P={key:0,style:{cursor:"pointer"},class:"ms-auto"},W={key:1,style:{cursor:"pointer"},class:"text-danger"},X={class:"todo-content"},q={class:"newTodo d-flex align-items-center"},Z={class:"newTodo-box d-flex"},oo=t("div",{class:"plus-pic"},[t("img",{src:M,alt:"plus"})],-1),to=[oo],so={class:"todos-box"},eo={class:"todos-top-btns"},no={class:"todo-lists"},ao=["onChange"],lo={key:1,class:"todo-lists-check"},io=t("img",{src:j,alt:"check"},null,-1),co=[io],ro={key:2},uo={key:3},Ao=["onClick"],go=["onClick"],r="https://todolist-api.hexschool.io",vo={__name:"TodoPage",setup(ho){const k=U(),h=A({}),d=A([]),c=y({content:""}),p=A(!1),f=A(null),b=async()=>{try{const o=await i.get(`${r}/users/checkout`);h.value=o.data}catch(o){console.error("驗證失敗:",o.message),alert(`驗證失敗: ${o.message}`),k.push("/")}},u=async()=>{try{const o=await i.get(`${r}/todos/`);d.value=o.data.data,console.log(d.value)}catch(o){console.log("獲取 todos 失敗:",o.message)}},I=async()=>{try{if(c.content.trim()===""){alert("請輸入內容");return}p.value?(await i.put(`${r}/todos/${f.value}`,c),console.log("更新成功")):(await i.post(`${r}/todos/`,c),console.log("新增成功")),await u(),Q()}catch(o){console.error("保存 Todo 失败:",o.message),alert(`保存 Todo 失败: ${o.message}`)}},x=o=>{c.content=o.content,p.value=!0,f.value=o.id},B=async o=>{try{await i.delete(`${r}/todos/${o}`),console.log("刪除成功"),await u()}catch(n){console.error("刪除 Todo 失败:",n.message)}},R=async o=>{try{await i.patch(`${r}/todos/${o}/toggle`),console.log("切換狀態成功"),await u()}catch(n){console.error("切換狀態失败:",n.message)}},T=async()=>{try{await i.post(`${r}/users/sign_out`),alert("登出成功"),k.push("/login")}catch(o){console.error("登出失敗:",o.message)}},Q=()=>{c.content="",p.value=!1,f.value=null},s=y({all:!0,finish:!1,noFin:!1}),F=C(()=>d.value.filter(o=>o.status===!1));async function v(o){o==="all"?(s.all=!0,s.finish=!1,s.noFin=!1):o==="finish"?(s.all=!1,s.finish=!0,s.noFin=!1):o==="noFin"&&(s.all=!1,s.finish=!1,s.noFin=!0),await u()}const S=C(()=>s.all===!0?d.value:s.finish===!0?d.value.filter(o=>o.status===!0):s.noFin===!0?d.value.filter(o=>o.status===!1):[]);return E(()=>{const o=document.cookie.replace(/(?:(?:^|.*;\s*)fabio20token\s*=\s*([^;]*).*$)|^.*$/,"$1");i.defaults.headers.common.Authorization=o,b(),u()}),(o,n)=>(l(),a("div",K,[z,t("div",L,[t("header",O,[J,h.value.status?(l(),a("p",P,[$(g(h.value.nickname),1),t("span",{onClick:w(T,["prevent"])},"登出")])):(l(),a("p",W,"未登入"))]),t("section",X,[t("div",q,[Y(t("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>c.content=e),placeholder:"新增/編輯",type:"text"},null,512),[[H,c.content,void 0,{trim:!0}]]),t("div",Z,[t("button",{onClick:w(I,["prevent"]),class:"m-auto btn d-flex p-0"},to)])]),t("div",so,[t("div",eo,[t("button",{onClick:n[1]||(n[1]=e=>v("all")),class:_(["todo-btn rounded-0",{active:s.all}])}," 全部 ",2),t("button",{onClick:n[2]||(n[2]=e=>v("noFin")),class:_(["todo-btn rounded-0",{active:s.noFin}])}," 待完成 ",2),t("button",{onClick:n[3]||(n[3]=e=>v("finish")),class:_(["todo-btn rounded-0",{active:s.finish}])}," 已完成 ",2)]),t("ul",no,[(l(!0),a(N,null,D(S.value,e=>(l(),a("li",{key:e.uid},[e.status?(l(),a("div",lo,co)):(l(),a("input",{key:0,type:"checkbox",onChange:m=>R(e.id)},null,40,ao)),e.status?(l(),a("p",uo,[t("del",null,g(e.content),1)])):(l(),a("p",ro,g(e.content),1)),e.status?G("",!0):(l(),a("i",{key:4,onClick:m=>x(e),class:"bi bi-pencil-square d-block ms-3"},null,8,Ao)),t("i",{onClick:m=>B(e.id),class:"bi bi-x-lg ms-auto"},null,8,go)]))),128)),t("aside",null,g(F.value.length)+" 個待完成項目",1)])])])])]))}};export{vo as default};
